<!DOCTYPE html>
<html ng-app="myApp">
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
    <link rel="stylesheet" href="base.css"/>
</head>
<body>
    <div ng-controller="MyController">
        {{ message }}
        <fileuploader></fileuploader>
    </div>

    <script src="bower_components/angular/angular.js"></script>
    <script>
        angular.module('myApp', []).controller('MyController', function ($scope) {
            $scope.message = 'Hello World!';
        }).directive('fileuploader', function () {
            // return a directive definition object
            return {
                restrict: 'E',
                template: '<button>Print To Console</button><ul></ul><div>{{message}}</div>',
                link: function (scope, element, attrs) {
                    /*element.on('click', function () {
                        console.log('Hello World from the fileuploader directive');
                    });*/


                    var ul = element[0].children[1];

                    element[0].firstElementChild.addEventListener('click', function () {
                        console.log(scope.message);
                        scope.message = 'Hmmm';
                        var inp = document.createElement('input');
                        inp.setAttribute('type', 'file');
                        inp.setAttribute('multiple', 'multiple');
                        inp.click();
                        inp.addEventListener('change', function () {
                            ul.innerHTML = '';
                            Array.prototype.forEach.call(this.files, function (eachFile) {
                                var li = document.createElement('li');
                                li.innerHTML = eachFile.name;
                                ul.appendChild(li);
                            });
                        });
                    });
                }
            };
        });
    </script>
</body>
</html>
